<link rel="stylesheet" href="css/budget.css"/>

<div class="container" id="bika-units-budget">
     <div class="row">
          <div class="col-xs-3">
      <!--Enterprise fiscal year selection-->

      <div class="panel panel-default">
        <div class="panel-heading">

          <h1 class="panel-title"><b>{{enterprise.name}}</b></h1>
          <span class="panel-title">{{enterprise.city}}</span>

        </div>  

        Search Accounts
        <input type="search" class="form-control" ng-model="filterAccounts">
        <div class="bika-scrollable">
        <table class="table table-hover table-bordered" id="bika-units-budgeting-list">
          <tr ng-click="select(account.id)" ng-class="{selected: account.id==selected.id}" ng-repeat="account in account_model.data | filter: filterAccounts"><td width="65px">{{account.id}}</td><td>{{account.account_txt}}</td></tr>
        </table>
        </div>
      </div>
          </div>
    <div class="col-xs-9">
        <div ng-switch on="active">

          <div ng-switch-default></div>
          <div ng-switch-when="report">
            <div class="bika-header">
              <div class="row">
               
              <h1>Budget Report <small>{{selected.account_txt}}</small></h1>
              <div class="row">
              <div class="col-lg-offset-7">
                <div class="input-group">
                 
                  <select class="form-control" ng-model="selected_fiscal" ng-options="f.fiscal_year_txt for f in fiscal_model.data"></select>
                   <span class="input-group-btn">
                    <btn class="btn btn-default" ng-click="compare()" type="button">Compare Year</btn>
                  </span>
                </div>
              </div>
              </div>
              </div>
            </div>

           <fieldset ng-repeat="report in budget_model.reports" ng-init="r_index = $index">    
                    <select class="form-control">

                    </select>

                     <table class="table table-bordered uniform">
                          <thead>
                                     <tr>
                                          <th>Period</th>
                                          <th>Actual</th>
                                          <th>Budget</th>
                                     </tr>
                                </thead>
                                <tbody>
                                     <tr ng-repeat="month in months" ng-init="row=filterMonth(report, $index)">
                                        <!--Use ng-init equivalent here, filterMonth is getting called a billion times-->

                                        <!--Make one function call instead of 3-->
                                        <td>{{filterMonth(report, $index).period_start | date:'MMM yyyy'}}</td>
                                        <!--TODO: implement 'actual'-->
                                        <td><span ng-show="filterMonth(report, $index)">{{0 | currency}}</span></td>
                                        <!--Use ng-if vs ng-hide (only available in latest RC)-->
                                        <td><input type="text" ng-show="filterMonth(report, $index)" ng-model="filterMonth(report, $index).budget"></td> <!--FIXME: Use row from ng-init, currently not updated given scoping issues-->

                                      </tr>
                                      <tr><td colspan="2">total</td><td>{{sum(report) | currency}}</td></tr>
                                </tbody>
                      </table>
           </fieldset>
           </div>
        </div>
     </div>
</div>