<link rel="stylesheet" href="partials/cash/index.css">
<h2>Cash Box</h2>
<hr />
<div class="container">

  <!-- search for invoice by invoice number or patient id -->
  <div class="row">
    <div class="col-xs-12" style="padding-right: 0;">
      <div class="panel panel-default">
        <div class="panel-heading">
          <span>Find by Invoice Note:</span>
        </div>
        <input
          class="form-control"
          type="text"
          ng-model="slip.invoice_id"
          typeahead="invoice.id as invoice.note for invoice in models['sale-debitor'] | limitTo: 8"
          typeahead-on-select="select()"
        >
      </div>
    </div>
  </div>
  
  <div class="row">
    <!-- make a list of outstanding invoices -->
    <div class="col-xs-2">
      <div class="panel panel-default">
        <div class="panel-heading">
          <span>Outstanding Invoices</span>  
        </div>
        <table class="table">
          <thead>
            <tr>
              <td>ID</td>
              <td>Amount</td>
            </tr>
          </thead>
          <tbody style="max-height: 200px; overflow-y: scroll;">
          <tr ng-repeat="inv in models['sale-debitor']" ng-click="select(inv.id,$index)" ng-class="{'chosen': $index==chosen}">
              <td>{{inv.id}}</td>
              <td>{{inv.cost | currency }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Register a receipt -->
    <div class="col-xs-10">
      <div class="row">
        <div class="panel" ng-class="{'panel-success': !submitted, 'panel-danger': submitted}"> 
          <div class="panel-heading">
            <span>Receipt</span> 
          </div>
          <div class="panel-body">
            <form name="receipt">
              <div class="row">
                <div class="col-xs-1">
                  <label>No:</label>
                  <div>{{slip.cashbox_id}}</div>
                </div>
                <div class="col-xs-2">
                  <label for="cash-bon">
                    Bon de Sortie
                  </label>
                  <input
                    class="form-control"
                    type="number"
                    name="cash-bon"
                    id="cash-bon" 
                    ng-model="slip.bon_num"
                    required
                    ng-disabled="submitted"
                  >
                </div>
                <div class="col-xs-2">
                  <label>
                    Date:
                  </label>
                  <div>{{slip.date | date }}</div>
                </div>
                <div class="col-sm-offset-4 col-xs-2">
                  <label>
                    Cash Account
                  </label>
                  <div><i>{{slip.debit_account}}</i></div>
                </div>
              </div>
              <div class="row">
                <div class="col-xs-9">
                  <label for="cash-invoice_text">
                    Text
                  </label>
                  <input
                    class="form-control"
                    id="cash-invoice_text"
                    name="cash-invoice_text"
                    type="text"
                    ng-model="slip.text"
                    required
                    ng-disabled="submitted"
                  >
                </div>
                <div class="col-xs-3">
                  <label for="cash-amount">
                    Amount
                  </label>
                  <div class="input-group">
                    <input
                      class="form-control"
                      id="cash-amount"
                      name="cash-amount" 
                      type="number"
                      ng-model="slip.amount"
                      required
                      ng-disabled="submitted"
                    >
                    <div class="input-group-btn">
                      <button type="button" class="btn btn-default dropdown-toggle">
                        {{formatCurrency(slip.currency_id)}}
                      </button>
                      <ul class="dropdown-menu pull-right">
                        <li ng-repeat="currency in models['currency']" ng-click="setCurrency($index)">
                          <a href="">{{currency.symbol}}</a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col-xs-2">
                  <label>
                    Credit Account:
                  </label> 
                  <div><i>{{slip.credit_account}}</i></div>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
      <!-- under form buttons -->
      <div class="row">
        <div class="col-sm-offset-9 col-xs-3">
          <button form="receipt" type="submit" class="btn btn-default" ng-disabled="!receipt.$valid || !slip.credit_account || submitted" ng-click="validate()">
            Submit
          </button>
          <!-- TODO: Make a review button hooked up to the 'review' subform -->
          <button form="receipt" type="reset" class="btn btn-default" ng-click="clear()">
            Clear
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
