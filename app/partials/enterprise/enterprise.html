<header class="hidden-print">
  <span>{{'ENTERPRISE.TITLE' | translate}}</span>
</header>

<section class="top-nav hidden-print">
  <button class="btn btn-default btn-sm" ng-click="newEnterprise()"><i class="glyphicon glyphicon-file"></i> {{ 'ENTERPRISE.NEW' | translate }}</button>
  <div class="pull-right">
    <button class="btn btn-default btn-sm" ng-click="print()"><i class="glyphicon glyphicon-print"></i> {{'UTIL.PRINT' | translate}}</button>
  </div>
</section>

<div class="visible-print" style="margin: 15px;">
  <h3>{{ 'ENTERPRISE.REGISTERED_ENTERPRISE' | translate }}</h3>
  <table class="table table-bordered">
    <thead>
      <tr>
        <th>{{ 'ENTERPRISE.NAME' | translate }}</th>
        <th>{{ 'ENTERPRISE.ABBREVIATION' | translate }}</th>
        <th>{{ 'ENTERPRISE.EMAIL' | translate }}</th>
        <th>{{ 'ENTERPRISE.PHONE' | translate }}</th>
        <th>{{ 'ENTERPRISE.LOCATION_ID' | translate }}</th>
        <th>{{ 'ENTERPRISE.CURRENCY' | translate }}</th>
      </tr>
    </thead>
    <tbody>
      <tr ng-repeat="e in enterprise.data">
        <td>{{ e.name }}</td>
        <td>{{ e.abbr }}</td>
        <td>{{ e.email }}</td>
        <td>{{ e.phone }}</td>
        <td>{{ e.location_id }}</td>
        <td> {{ currency.get(e.currency_id).name }}</td>
      </tr>
    </tbody>
  </table>
</div>

<div class="content">

  <div class="row">

    <div class="hidden-print">
      <div class="col-xs-6">
        <div class="panel panel-default" style="overflow: auto;">
          <div class="panel-heading">
            <span> {{ 'ENTERPRISE.EXISTING_ENTERPRISES' | translate }}</span>
          </div>
          <table class="table table-condensed table-hover">
            <thead>
              <tr>
                <th>{{ 'ENTERPRISE.NAME' | translate }}</th>
                <th>{{ 'ENTERPRISE.ABBREVIATION' | translate }}</th>
                <th>{{ 'ENTERPRISE.EMAIL' | translate }}</th>
                <th>{{ 'ENTERPRISE.PHONE' | translate }}</th>
                <th>{{ 'ENTERPRISE.EDIT' | translate }}</th>
              </tr>
            </thead>
            <tbody>
              <tr ng-repeat="e in enterprise.data" ng-click="load(e)">
                <td>{{e.name}}</td>
                <td>{{e.abbr}}</td>
                <td>{{e.email}}</td>
                <td>{{e.phone}}</td>
                <td><button class="btn btn-sm btn-default" ng-click="editEnterprise(e)"><i class="glyphicon glyphicon-pencil"></i></button></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="col-xs-6" ng-switch="action">
        <div ng-switch-default>
          <div class="alert alert-info">
            <h4>{{ 'ENTERPRISE.TITLE' | translate }}</h4>
            <p>{{ 'ENTERPRISE.HELP_TEXT_1' | translate }}
            </p>
            <ul class="list-plain">
              <li><i class="glyphicon glyphicon-pencil"></i> {{ 'ENTERPRISE.HELP_TEXT_2' | translate }}</li>
              <li><i class="glyphicon glyphicon-file"></i> {{ 'ENTERPRISE.HELP_TEXT_3' | translate }}</li>
            </ul>
          </div>
        </div>

        <div ng-switch-when="new">
          <form novalidate name="newForm">
            
            <fieldset>
              <legend>{{ 'ENTERPRISE.CONFIGURATION' | translate }}</legend>
              <div class="form-group">
                <label for="kpk-enterprise-name">{{ 'ENTERPRISE.NAME' | translate }} </label>
                <input type="text" class="form-kapok" name="kpk-enterprise-name" id="kpk-enterprise-name" ng-model="add.name">
              </div>

              <div class="form-group">
                <label for="kpk-enterprise-abbr" >{{ 'ENTERPRISE.ABBREVIATION' | translate }} </label>
                <input type="text" class="form-kapok" name="kpk-enterprise-abbr" id="kpk-enterprise-abbr" ng-model="add.abbr">
              </div>

              <div class="form-group">
                <label for="kpk-enterprise-email">{{ 'ENTERPRISE.EMAIL' | translate }} </label>
                <input type="email" class="form-kapok" name="kpk-enterprise-email" id="kpk-enterprise-email" ng-model="add.email">
              </div>

              <div class="form-group">
                <label for="kpk-enterprise-phone" >{{ 'ENTERPRISE.PHONE' | translate }} </label>
                <input type="tel" class="form-kapok" name="kpk-enterprise-phone" id="kpk-enterprise-phone" ng-model="add.phone">
              </div>

              <div class="form-group">
                <label for="kpk-enterprise-location" class="required">{{ 'ENTERPRISE.LOCATION' | translate }} </label>
                <select class="form-kapok" name="kpk-enterprise-location" id="kpk-enterprise-location" ng-model="add.location_id" ng-options="loc.id as fLocation(loc) for loc in location">
                  <option value="" disabled="disabled">-- Select a Location --</option>
                </select>
              </div>

            </fieldset>
            <fieldset> 
              <legend>{{ 'ENTERPRISE.CURRENCY_CASH_MANAGEMENT' | translate }}</legend> 

              <div class="radio" ng-repeat="currency in currency.data">
                <label>
                  {{currency.name}}
                  <input type="radio" value="{{currency.id}}" name="kpk-enterprise-currency" ng-model="add.currency_id">
                </label>
              </div>

            </fieldset>

            <input type="submit" class="btn btn-sm btn-success" ng-click="saveNew()" value="{{ 'FORM.SAVE' | translate }}" ng-disabled="newForm.$invalid">
            <input type="reset" class="btn btn-sm btn-default" ng-click="resetNew()" value="{{ 'FORM.RESET_FORM' | translate }}">

          </form>
        </div>

        <div ng-switch-when="edit">
          <form novalidate name="editForm">
            
            <fieldset>
              <legend>{{ "ENTERPRISE.EDIT_ENTERPRISE" | translate }}</legend>
              <div class="form-group">
                <label for="kpk-enterprise-name" class="required">{{ 'ENTERPRISE.NAME' | translate }} </label>
                <input class="form-kapok" name="kpk-enterprise-name" id="kpk-enterprise-name" ng-model="edit.name" required>
              </div>

              <div class="form-group">
                <label for="kpk-enterprise-abbr" >{{ 'ENTERPRISE.ABBREVIATION' | translate }} </label>
                <input class="form-kapok" name="kpk-enterprise-abbr" id="kpk-enterprise-abbr" ng-model="edit.abbr">
              </div>

              <div class="form-group">
                <label for="kpk-enterprise-email" >{{ 'ENTERPRISE.EMAIL' | translate }} </label>
                <input type="email" class="form-kapok" name="kpk-enterprise-email" id="kpk-enterprise-email" ng-model="edit.email">
              </div>

              <div class="form-group">
                <label for="kpk-enterprise-phone" >{{ 'ENTERPRISE.PHONE' | translate }} </label>
                <input type="tel" class="form-kapok" name="kpk-enterprise-phone" id="kpk-enterprise-phone" ng-model="edit.phone">
              </div>

              <div class="form-group">
                <label for="kpk-enterprise-location" class="required">{{ 'ENTERPRISE.LOCATION' | translate }} </label>
                <select class="form-kapok" name="kpk-enterprise-location" id="kpk-enterprise-location" ng-model="edit.location_id" ng-options="loc.id as fLocation(loc) for loc in location" required>
                  <option value="" disabled="disabled">-- Select a Location --</option>
                </select>
              </div>

            </fieldset>
            <fieldset> 
              <legend>{{ 'ENTERPRISE.CURRENCY_CASH_MANAGEMENT' | translate }}</legend> 

              <input type="button" class="btn btn-sm btn-default" value="{{ 'ENTERPRISE.MANAGE_CASH_ACCOUNTS' | translate }}" ng-click="manageAccounts()">

              <div class="radio" ng-repeat="currency in currency.data">
                <label>
                  {{currency.name}}
                  <input type="radio" value="{{currency.id}}" name="kpk-enterprise-currency" ng-model="edit.currency_id">
                </label>
              </div>

            </fieldset>

            <input type="submit" class="btn btn-sm btn-success" ng-click="saveEdit()" value="{{ 'FORM.SAVE_CHANGES' | translate }}" ng-disabled="editForm.$invalid">
            <input type="button" class="btn btn-sm btn-default" ng-click="resetEdit()" value="{{ 'FORM.RESET_FORM' | translate }}">

          </form>
        </div>

        <div ng-switch-when="manage">
          <table class="table table-condensed  ">
            <thead>
              <tr><th colspan="5">{{ 'ENTERPRISE.REGISTERED_RELATIONS' | translate }}</th></tr>
              <tr>
                <th> {{ 'ENTERPRISE.CURRENCY' | translate }}</th>
                <th> {{ 'ENTERPRISE.CASH_ACCOUNT' | translate }}</th>
                <th> {{ 'ENTERPRISE.BANK_ACCOUNT' | translate }}</th>
                <th> {{ 'ENTERPRISE.ACTIONS' | translate }}</th>
              </tr>
            </thead>
            <tbody>
              <tr ng-repeat="acc in currency_account.data">
                <td>{{ currency.get(acc.currency_id).name }}  ({{currency.get(acc.currency_id).symbol}})</td>
                <td>{{ account.get(acc.cash_account).account_number }}</td>
                <td>{{ account.get(acc.bank_account).account_number }}</td>
                <td><button class="btn btn-danger btn-sm" ng-click="removeAccount(acc.id)"><i class="glyphicon glyphicon-trash"></i></button></td>
              </tr>
            </tbody>
          </table>

          <form>
            <fieldset>
              <legend>{{ 'ENTERPRISE.ADD_CURRENCY_ACCOUNT' | translate }}</legend>

              <div class="form-group">
                <label>{{ 'ENTERPRISE.CURRENCY' | translate }}</label>
                <select class="form-kapok" ng-model="newAccount.currency_id" ng-options="currency.id as currency.name+' ('+currency.symbol+')' for currency in currency.data">
                  <option value="">-- {{ 'SELECT.CURRENCY' | translate }} --</option>
                </select>
              </div>

              <div class="form-group">
                <label >{{ 'ENTERPRISE.CASH_ACCOUNT' | translate }}</label>
                <select class="form-kapok" ng-model="newAccount.cash_account" ng-options="account.id as account.account_number+' -- '+account.account_txt for account in account.data">
                  <option value="">-- {{ 'SELECT.ACCOUNT' | translate }} --</option>
                </select>
              </div>

              <div class="form-group">
                <label >{{ 'ENTERPRISE.BANK_ACCOUNT' | translate }}</label>
                <select class="form-kapok" ng-model="newAccount.bank_account" ng-options="account.id as account.account_number+' -- '+account.account_txt for account in account.data">
                  <option value="">-- {{ 'SELECT.ACCOUNT' | translate }} --</option>
                </select>
              </div>


              <input type="submit" class="btn btn-success btn-sm" ng-click="saveAccounts()" value="{{ 'UTIL.SAVE_SELECTION' | translate }}">
              <input type="button" class="btn btn-sm btn-default" ng-click="resetAccounts()" value="{{ 'UTIL.RESET_FORM' | translate }}">

            </fieldset>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
