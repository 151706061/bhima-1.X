<header>
  <span>Configure Exchange Rates</span>
</header>


<section class="underline">
  <div class="pull-right">
    <button type="button" class="btn btn-sm btn-default" ng-click="showCalculator=!showCalculator">Calculator</button>
  </div>
</section>

<div class="content">

  <div class="row">
    <div class="col-xs-6">
      <table class="table table-bordered table-condensed">
        <thead>
          <tr><th>Date</th><th>Currency 1</th><th>Currency 2</th><th>Rate</th></tr>
        </thead>
        <tbody>
          <tr ng-repeat="rate in rates.data | limitTo: 12">
            <td>{{rate.date | date}}</td><td>{{ currency.get(rate.enterprise_currency_id).name}}</td><td>{{currency.get(rate.foreign_currency_id).name }}</td><td>{{ rate.rate }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="col-xs-6" ng-cloak>

      <div class="panel panel-default" ng-if="!!currentRates.length">
        <div class="panel-heading">
          <span>Today's ({{ today | date}}) Exchange Rates:</span>
        </div>
        <div class="panel-body">
          <form class="form-horizontal">

            <div class="form-group" ng-repeat="rate in currentRates">
              <label class="control-label col-xs-2">{{ currency.get(rate.foreign_currency_id).name }}</label>
              <div class="col-xs-4">
                <p class="form-control-static" ng-bind-html="rate.rate | intlcurrency:rate.foreign_currency.id"></p>
              </div>
            </div>

          </form>
        </div>
      </div>
    
      <div class="panel panel-default">
        <div class="panel-body">
          <form name="kpk-exchange-form" class="form-horizontal">
            <fieldset>
              <legend>Set Exchange Rate</legend>

              <div class="form-group">
                <div class="col-xs-5">
                  <div class="form-kapok" style="text-align: center;">
                    {{ currency.get(enterprise.currency_id).name }}
                  </div>
                </div>

                <div class="col-sm-offset-1 col-xs-5">
                  <select 
                    class="form-kapok"
                    id="kpk-exchange-currency2"
                    name="kpk-exchange-currency2"
                    ng-model="newRate.foreign_currency_id"
                    ng-options="currency.id as currency.name for currency in currency.data | filter:filterOptions"
                  >
                    <option value="" disabled="disabled">-- Select Currency --</option>
                  </select>
                </div>
              </div>

              <div class="form-group">
                <div class="col-xs-5 input-group">
                  <input class="form-kapok" value="1" disabled="disabled">
                  <span class="input-group-addon">
                    {{ currency.get(enterprise.currency_id).symbol }}
                  </span>
                </div>
                <label class="col-xs-1 control-label">
                  <i class="glyphicon glyphicon-arrow-right"></i>
                </label>
                <div class="col-xs-5 input-group">
                  <input class="form-kapok" ng-model="newRate.rate" min="0" required placeholder="1.00" type="number">
                  <span class="input-group-addon">
                    {{currency.get(newRate.foreign_currency_id).symbol}}
                  </span> 
                </div>
              </div>
            </fieldset>
            <input type="submit" form="exchange" class="btn btn-success btn-sm" ng-click="submit()" ng-disabled="valid()">
          </form>
        </div>
      </div>

      <div class="panel panel-default" ng-show="showCalculator">
        <div class="panel-heading">
          <span>Calculator</span>
          <span class="pull-right">
            <button type="button" ng-click="showCalculator=!showCalculator">X</button>
          </span>
        </div>
        <div k-calculator="value"></div>
      </div>

    </div>
  </div>
</div>
