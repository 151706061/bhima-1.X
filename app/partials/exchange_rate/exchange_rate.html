<header>
  <span>Configure Exchange Rates</span>
</header>

<section class="top-nav">
  <a href="" class="btn btn-sm btn-default" ng-click="action='new'"><i class="glyphicon glyphicon-file"></i> New Exchange Rate</a>
  <a href="" class="btn btn-sm btn-default" ng-click="action='review'"><i class="glyphicon glyphicon-list"></i> Review Today's Rates</a>
</section>

<div class="content">

  <div class="row">
    <div class="col-xs-6">
      <h3 style="margin-top:inherit;">Previous Rates</h3>
      <table class="table table-bordered table-condensed">
        <thead>
          <tr>
            <th>Date</th>
            <th>Enterprise Currency</th>
            <th>Other Currency</th>
            <th>Rate</th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="rate in rates.data | orderBy:'date' | limitTo: 12">
            <td>{{rate.date | date}}</td>
            <td>{{ currency.get(rate.enterprise_currency_id).name}}</td>
            <td>{{currency.get(rate.foreign_currency_id).name }}</td>
            <td>{{ rate.rate }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="col-xs-6" ng-switch="action">

      <div ng-switch-default>
        <div class="alert alert-info">
          <h4>Exchange Rate Module</h4>
          <p>
            The exchange rate module provides the facilty to set daily exchange rates. In order
            to ensure data integrity, an exchange rate for <b>all</b> functional currencies must
            be set <b>daily</b>.
          </p>
        </div>
      </div>

      <div class="panel panel-default" ng-switch-when="review">
        <div class="panel-heading">
          <span>Exchange rate for <b>{{ today | date}}</b></span>
        </div>
        <div class="panel-body">
          <form class="form-horizontal">

            <div class="form-group" ng-repeat="rate in currentRates">
              <label class="control-label col-xs-3">
                {{ currency.get(rate.foreign_currency_id).name }} Rate
              </label>
              <div class="col-xs-1">
                <p class="form-control-static"> 1  <b>::</b></p>
              </div>
              <div class="col-xs-4">
                <p class="form-control-static" ng-bind-html="rate.rate | intlcurrency:rate.foreign_currency_id"></p>
              </div>
            </div>

          </form>
        </div>
      </div>
    
      <div class="panel panel-default" ng-switch-when="new">
        <div class="panel-body">
          <form name="exchangeForm" class="form-horizontal" novalidate>
            <fieldset>
              <legend>Set Exchange Rate</legend>

              <div class="form-group">
                <div class="col-xs-5">
                  <div class="form-kapok" style="text-align: center;" disabled="disabled">
                    {{ currency.get(enterprise.currency_id).name }}
                  </div>
                </div>

                <div class="col-sm-offset-1 col-xs-5">
                  <select class="form-kapok" ng-model="newRate.foreign_currency_id" ng-options="c.id as c.name for c in currency.data | filter:fcurrency" required>
                    <option value="" disabled="disabled">-- Select Currency --</option>
                  </select>
                </div>
              </div>

              <div class="form-group">
                <div class="col-xs-5 input-group">
                  <input class="form-kapok" value="100" disabled="disabled">
                  <span class="input-group-addon">
                    {{ currency.get(enterprise.currency_id).symbol }}
                  </span>
                </div>
                <label class="col-xs-1 control-label">
                  <i class="glyphicon glyphicon-arrow-right"></i>
                </label>
                <div class="col-xs-5 input-group">
                  <input class="form-kapok" ng-model="newRate.rate" min="0" required placeholder="1.00" type="number" required>
                  <span class="input-group-addon">
                    {{currency.get(newRate.foreign_currency_id).symbol}}
                  </span> 
                </div>
              </div>
            </fieldset>

            <input type="submit" class="btn btn-success btn-sm" ng-click="submit()" ng-disabled="exchangeForm.$invalid">

          </form>
        </div>
      </div>

    </div>
  </div>
</div>
