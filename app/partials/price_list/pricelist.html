<header>
  {{ "PRICE_LIST.TITLE" | translate }}
</header>

<section class="top-nav">
  <button class="btn btn-sm btn-default" ng-click="addList()">
    <span class="glyphicon glyphicon-plus-sign"></span> {{ "PRICE_LIST.NEW" | translate }}
  </button>
</section>

<div class="content">

  <div class="row">
    <div class="col-xs-4">
      <div class="panel panel-default">
        <div class="panel-heading">
          <span>{{ "PRICE_LIST.ACTIONS" | translate }}</span>
        </div>
        <table class="table table-condensed">
          <thead>
            <tr>
              <th>{{ "COLUMNS.NAME" | translate }}</th>
              <th>{{ "COLUMNS.DISCOUNT" | translate }}</th>
              <th colspan="3" style="width: 20%;">{{ "COLUMNS.ACTION" | translate }}</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="list in model.priceList.data">
              <td> {{ list.name }} </td>
              <td> {{ list.discount }} </td>
              <td>
                <a class="btn btn-sm btn-default" ng-click="editMeta(list)" href=""><i class="glyphicon glyphicon-pencil"></i></a>
              </td>
              <td>
                <a class="btn btn-sm btn-danger" ng-click="removeList(list)" href=""><i class="glyphicon glyphicon-trash"></i></a>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="col-xs-8" ng-switch="action">

      <div class="alert alert-info" ng-switch-default>
        <h4>{{ "PRICE_LIST.TITLE" | translate }}</h4>
        <p>{{ "PRICE_LIST.HELP_TXT_1" | translate }}</p>
        <ul style="list-style-type: none; padding-left: 15px;">
          <li><i class="glyphicon glyphicon-cog"></i> {{ "PRICE_LIST.HELP_TXT_2" | translate }}</li>
          <li><i class="glyphicon glyphicon-trash"></i> {{ "PRICE_LIST.HELP_TXT_3" | translate }}</li>
        </ul>
      </div>
      
      <div ng-switch-when="meta">
        <form name="editPriceList" class="form-horizontal">
          <fieldset>

            <legend>{{ "PRICE_LIST.EDIT" | translate }}</legend>

            <div class="form-group">
              <label class="col-xs-2 control-label required">{{ "COLUMNS.NAME" | translate }}</label>
              <div class="col-xs-5">
                <input class="form-kapok" ng-model="edit.name">
              </div>
            </div>           

            <div class="form-group">
              <label class="col-xs-2 control-label required">{{ "COLUMNS.DISCOUNT" | translate }}</label>
              <div class="col-xs-5">
                <input class="form-kapok" ng-model="edit.discount">
              </div>
            </div>

            <div class="form-group">
              <label class="col-xs-2 control-label">
                {{ "COLUMNS.NOTE" | translate }}
              </label>
              <div class="col-xs-5">
                <input class="form-kapok" ng-model="edit.note">
              </div>
            </div>
 
            <input type="submit" class="btn btn-sm btn-success" ng-click="saveMeta()" value="{{ 'FORM.SAVE_CHANGES' | translate }}">
            <input type="reset" class="btn btn-sm btn-default" ng-click="resetMeta()" value="{{ 'FORM.RESET_FORM' | translate }}">

          </fieldset>
        </form>
      </div>

      <div ng-switch-when="add">
        <form name="editPriceList" class="form-horizontal">
          <fieldset>

            <legend>{{ "PRICE_LIST.ADD" | translate }}</legend>

            <div class="form-group">
              <label class="col-xs-2 control-label required">{{ "COLUMNS.NAME" | translate }}</label>
              <div class="col-xs-5">
                <input class="form-kapok" ng-model="add.name">
              </div>
            </div>

            <div class="form-group">
              <label class="col-xs-2 control-label required">{{ "COLUMNS.DISCOUNT" | translate }}</label>
              <div class="col-xs-5">
                <input type="number" class="form-kapok" ng-model="add.discount">
              </div>
            </div>
            
            <div class="form-group">
              <label class="col-xs-2 control-label">{{ "COLUMNS.NOTE" | translate }}</label>
              <div class="col-xs-5">
                <input class="form-kapok" ng-model="add.note">
              </div>
            </div>

            <input type="submit" class="btn btn-sm btn-success" ng-click="saveAdd()" value="{{ 'FORM.SAVE_CHANGES' | translate }}">
            <input type="reset" class="btn btn-sm btn-default" ng-click="resetAdd()" value="{{ 'FORM.RESET' | translate }}">

          </fieldset>
        </form>
      </div>

      <div ng-switch-when="item">
        <div class="panel panel-default">
          <div class="panel-heading">
            <span> <b>{{ "PRICE_LIST.DETAILS" | translate }}</b> </span>
            <span>
              <a href="" class="btn btn-sm btn-default" ng-click="addItem()" ng-disabled="!canSave">Add an Item</a>
              <a href="" class="btn btn-sm btn-default" ng-click="saveList()" ng-disabled="!canSave">Save List</a>
            </span>
          </div>

          <table class="table table-bordered table-condensed">
            <thead>
              <tr>
                <th style="width: 25%;">{{ "COLUMNS.INVENTORY_ITEM" | translate }}</th>
                <th style="width: 25%;">{{ "COLUMNS.PRICE" | translate }}</th>
                <th style="width: 5%;">{{ "COLUMNS.DISCOUNT" | translate }}</th>
                <th style="width: 35%;">{{ "COLUMNS.NOTE" | translate }}</th>
                <th colspan="2">{{ "COLUMNS.ACTIONS" | translate }}</th>
              </tr>
            </thead>
            <tbody>
              <tr ng-repeat="detail in details.data">

                <td ng-show="!detail.editing">{{ inventory.get(detail.inventory_id).code }}</td>
                <td style="padding: 0; margin: 0;" ng-hide="!detail.editing">
                  <select class="form-kapok" ng-model="detail.inventory_id" ng-options="item.id as item.code for item in inventory.data | filter:filterInventory">
                    <option value="">-- {{ "SELECT.INVENTORY_ITEM" | translate }} --</option>
                  </select>
                </td>

                <td ng-show="!detail.editing">{{detail.amount}}</td> <!-- flag for boolean if price -->
                <td style="padding: 0; margin: 0;" ng-hide="!detail.editing">
                  <input type="number" class="form-kapok" ng-model="detail.amount">
                </td> 

                <td style="padding: 0; margin: 0;">
                  <div style="text-align: center; vertial-align: middle;">
                    <input style="vertial-align: middle;" type="checkbox" ng-checked="!!detail.percent" ng-true-value="1" ng-false-value="0" ng-model="detail.percent" ng-disabled="!detail.editing">
                  </div>
                </td>

                <td ng-show="!detail.editing">{{detail.note}}</td>
                <td style="padding: 0; margin: 0;" ng-hide="!detail.editing">
                  <input type="text" class="form-kapok" ng-model="detail.note">
                </td>

                <td style="padding: 0; margin: 0;">
                  <button class="btn btn-sm" ng-class="{'btn-success' : !!detail.editing, 'btn-default' : !detail.editing, 'btn-warning' : !detail.editing && !isValid(detail)}" ng-click="detail.editing=!detail.editing"><i class="glyphicon" ng-class="{'glyphicon-floppy-disk' : !!detail.editing, 'glyphicon-pencil' : !detail.editing}"></i></button>
                </td>
                <td style="padding: 0; margin: 0;">
                  <button class="btn btn-sm btn-danger" ng-click="removeItem($index)"><i class="glyphicon glyphicon-trash"></i></button>
                </td>

              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
